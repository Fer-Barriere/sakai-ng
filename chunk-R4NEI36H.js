import{a as p,i as l}from"./chunk-H4QU3PKA.js";import{Q as c,V as a}from"./chunk-J35SX277.js";var n=class extends Error{};n.prototype.name="InvalidTokenError";function g(r){return decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let o=t.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function f(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return g(e)}catch{return atob(e)}}function d(r,e){if(typeof r!="string")throw new n("Invalid token specified: must be a string");e||(e={});let t=e.header===!0?0:1,o=r.split(".")[t];if(typeof o!="string")throw new n(`Invalid token specified: missing part #${t+1}`);let s;try{s=f(o)}catch(i){throw new n(`Invalid token specified: invalid base64 for part #${t+1} (${i.message})`)}try{return JSON.parse(s)}catch(i){throw new n(`Invalid token specified: invalid json for part #${t+1} (${i.message})`)}}var u=class r{constructor(e,t){this.http=e;this.router=t}apiUrl="https://bluelockb.onrender.com/api/usuarios";login(e,t){return this.http.post(`${this.apiUrl}/login`,{email:e,password:t})}register(e,t){return this.http.post(`${this.apiUrl}/register`,{email:e,password:t})}decodeToken(e){return d(e)}isTokenExpired(e){let o=this.decodeToken(e).exp*1e3;return Date.now()>o}logout(){localStorage.removeItem("token"),this.router.navigate(["/auth/login"])}isAuthenticated(){let e=this.getToken();return e?this.isTokenExpired(e)?(this.logout(),!1):localStorage.getItem("token")!==null:!1}getToken(){return localStorage.getItem("token")}static \u0275fac=function(t){return new(t||r)(a(p),a(l))};static \u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})};export{u as a};
